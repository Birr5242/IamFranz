<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hobbys – Franz Barjak</title>

  <!-- Haupt-Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Styles für das Boxkampf-Demo -->
  <link rel="stylesheet" href="static/css/boxfight.css" />
</head>
<body>
  <nav>
    <a href="index.html">Start</a>
    <a href="lebenslauf.html">Lebenslauf</a>
    <a href="hobbys.html">Hobbys</a>
    <a href="kontakt.html">Kontakt</a>
    <a href="video.html">Video</a>
  </nav>

  <main class="container">
    <h1>Meine Hobbys</h1>
    <p>Eines meiner liebsten Hobbys ist Boxen. Ich trainiere regelmäßig und spiele auch Gitarre.</p>
    <p>Klicke auf Start, um das Boxspiel zu beginnen.</p>
    <button id="startButton" disabled>Start (lade Assets)</button>

    <section id="gameSection" class="game-wrapper" style="display:none; margin-top:16px;">
      <div class="hud">
        <div class="player-hp">
          <div id="player-name">Du</div>
          <div class="bar"><div id="player-health" class="health"></div></div>
        </div>
        <div class="enemy-hp">
          <div id="enemy-name">Gegner</div>
          <div class="bar"><div id="enemy-health" class="health"></div></div>
        </div>
      </div>

      <canvas id="game" width="900" height="420" aria-label="2D Boxkampf Spiel"></canvas>

      <div class="controls">
        <div class="instructions">
          <strong>Steuerung (Desktop):</strong> A/D = links/rechts, W = Sprung, J = Schlag, K = Tritt<br/>
          <strong>Mobile:</strong> Nutze die Buttons unten.
        </div>

        <div class="mobile-buttons" id="mobile-buttons">
          <button class="btn move" data-action="left">◀</button>
          <button class="btn move" data-action="right">▶</button>
          <button class="btn action" data-action="jump">↑</button>
          <button class="btn action" data-action="punch">Schlag</button>
          <button class="btn action" data-action="kick">Tritt</button>
        </div>

        <div class="actions">
          <button id="restart">Neustart</button>
          <label>
            KI-Schwierigkeit:
            <select id="difficulty">
              <option value="0.6">Leicht</option>
              <option value="0.8" selected>Mittel</option>
              <option value="1.0">Schwer</option>
            </select>
          </label>
        </div>
      </div>

      <div id="message" class="message" aria-live="polite"></div>

      <p class="footnote">Kleine Demo: Änderungen am Balancing, Grafiken oder Sound sind leicht möglich — sag Bescheid, wenn du das in dein Framework eingebunden haben möchtest.</p>
    </section>
  </main>

  <!-- Spiel-Logik -->
  <script src="static/js/boxfight.js"></script>

  <!-- Asset-Preloader und Start-Integration -->
  <script>
    // Passe hier die Pfade an die tatsächlichen Dateinamen an
    const ASSETS = {
      bg: <img src=" /bg.jpg">,              // Hintergrundbild
      player: <img src=" /player.png">,      // Spieler-Sprite
      enemy: <img src=" /enemy.png">         // Gegner-Sprite
      // Füge hier weitere assets hinzu falls benötigt
    };

    function preloadImages(list) {
      const keys = Object.keys(list);
      const images = {};
      let loaded = 0;
      let failed = 0;

      return new Promise(resolve => {
        if (keys.length === 0) return resolve(images);

        keys.forEach(key => {
          const img = new Image();
          img.src = list[key];
          img.onload = () => {
            images[key] = img;
            loaded++;
            if (loaded + failed === keys.length) resolve({images, failed});
          };
          img.onerror = () => {
            console.error('Asset konnte nicht geladen werden:', list[key]);
            failed++;
            if (loaded + failed === keys.length) resolve({images, failed});
          };
        });
      });
    }

    (function () {
      const startBtn = document.getElementById('startButton');
      const gameSection = document.getElementById('gameSection');

      // Preload starten
      preloadImages(ASSETS).then(({images, failed}) => {
        if (failed > 0) {
          console.warn(failed + ' Asset(s) konnten nicht geladen werden. Prüfe die Pfade in hobbys.html und den images-Ordner.');
        } else {
          console.log('Alle Assets geladen.');
        }

        // Mach die Bilder global verfügbar für boxfight.js falls es sie nutzen kann
        window.PRELOADED_ASSETS = images;

        // Falls boxfight.js bietet eine Init-Funktion, rufe sie jetzt auf
        if (typeof BoxFightInit === 'function') {
          try { BoxFightInit(images); } catch (e) { console.warn('BoxFightInit Fehler', e); }
        }
        if (typeof startBoxFight === 'function') {
          try { startBoxFight(images); } catch (e) { console.warn('startBoxFight Fehler', e); }
        }

        // Button aktivieren
        startBtn.disabled = false;
        startBtn.textContent = 'Start';
      });

      // Start-Button Funktionalität
      startBtn.addEventListener('click', function () {
        gameSection.style.display = 'block';
        gameSection.scrollIntoView({ behavior: 'smooth' });
        const canvas = document.getElementById('game');
        canvas && canvas.focus && canvas.focus();

        // Falls boxfight.js bietet eine explizite start-Funktion
        if (typeof BoxFightStart === 'function') {
          try { BoxFightStart(); } catch (e) { console.warn('BoxFightStart Fehler', e); }
        } else if (typeof startGame === 'function') {
          try { startGame(); } catch (e) { console.warn('startGame Fehler', e); }
        } else {
          // Viele Implementierungen initialisieren selbst beim Laden oder beim Klick auf Start,
          // falls dein boxfight.js intern images per Pfad lädt, prüfe die Pfade dort.
          console.log('Spiel gestartet. Falls kein Bild erscheint, kontrolliere die Pfade im static/js/boxfight.js.');
        }
      });
    })();
  </script>
</body>
</html>

